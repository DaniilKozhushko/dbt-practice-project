# dbt practice project

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–µ–∫—Ç dbt (Data Build Tool), —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –≤ —Ä–∞–º–∫–∞—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –ü—Ä–æ–µ–∫—Ç –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö: –æ—Ç —Å—ã—Ä—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–æ –≤–∏—Ç—Ä–∏–Ω –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫ –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ç–µ–∫

- dbt Core (—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)
- SQL (–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã)
- Jinja (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π SQL –∏ –º–∞–∫—Ä–æ—Å—ã)
- Python / Airflow (–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è)
- DB: PostgreSQL

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –º–æ–¥—É–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å–ª–æ–∏—Å—Ç–æ—Å—Ç–∏:

1. **Sources:** –û–ø–∏—Å–∞–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

2. **Staging:** –û—á–∏—Å—Ç–∫–∞ –∏ –±–∞–∑–æ–≤–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ephemeral –∏ view).

3. **Intermediate:** –°–ª–æ–∂–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ –¥–∂–æ–π–Ω—ã.

4. **Mart:** –§–∏–Ω–∞–ª—å–Ω—ã–µ –≤–∏—Ç—Ä–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è BI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (table, materialized view).

## üõ† –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
–í —Ö–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞ –±—ã–ª–∏ –≤–Ω–µ–¥—Ä–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–¥—Ö–æ–¥—ã:

*–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ incremental –º–æ–¥–µ–ª–∏.

*–ò—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å (SCD Type 2):* –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ snapshots –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–∏.

*–ú–µ—Ç–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ:* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Jinja –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –º–∞–∫—Ä–æ—Å–æ–≤ –¥–ª—è DRY (Don't Repeat Yourself) –∫–æ–¥–∞.

*Data Vault 2.0:* –ü—Ä–∞–∫—Ç–∏–∫–∞ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞–∫–µ—Ç–∞ automate_dv.

*–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Apache Airflow –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.

## üß™ –ö–∞—á–µ—Å—Ç–≤–æ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–≤–µ—Ä–æ–∫:

**Generic Tests:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ unique, not_null, relationships.

**Singular Tests:** –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ SQL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.

**Unit Tests:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –º–æ–¥–µ–ª–µ–π –Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

**Linter/Audit:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞ dbt_project_evaluator –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è Best Practices.

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/DaniilKozhushko/dbt-practice-project.git
```

```bash
cd dbt-practice-project
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

#### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ dbt:
```bash
pip install dbt-postgres
```

#### –ù–∞—Å—Ç—Ä–æ–π—Ç–µ profiles.yml:

```bash
dbt_practice_project:
  outputs:
    dev:
      dbname: dwh_flights
      host: localhost
      pass: mysecretpassword
      port: 4001
      schema: intermediate
      threads: 4
      type: postgres
      user: postgres
  target: dev
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
dbt deps
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:

```bash
dbt seed # –ó–∞–≥—Ä—É–∑–∫–∞ CSV —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
```
```bash
dbt run # –°–±–æ—Ä–∫–∞ –º–æ–¥–µ–ª–µ–π
```
```bash
dbt test # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```

## üìÉ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω. –ß—Ç–æ–±—ã –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é —Å—Ö–µ–º—É —Å–≤—è–∑–µ–π (Lineage Graph) –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
dbt docs generate
```
```bash
dbt docs serve
```